# TP tests statistiques

# Ex 1
vit <-c(
850, 740, 900, 1070, 930, 850, 950, 980, 980, 880, 1000, 980, 930, 650, 760,
810, 1000, 1000, 960, 960, 960, 940, 960, 940, 880, 800, 850, 880, 900, 840,
830, 790, 810, 880, 880, 830, 800, 790, 760, 800, 880, 880, 880, 860, 720,
720, 620, 860, 970, 950, 880, 910, 850, 870, 840, 840, 850, 840, 840, 840,
890, 810, 810, 820, 800, 770, 760, 740, 750, 760, 910, 920, 890, 860, 880,
720, 840, 850, 850, 780, 890, 840, 780, 810, 760, 810, 790, 810, 820, 850,
870, 870, 810, 740, 810, 940, 950, 800, 810, 870)

vit <- vit + 299000
vit

m0 <- 299734.5
alpha <- 0.05

t.test(vit,mu=m0,conf.level=1-alpha,alternative="t")

# Ex 2
gaz <- c(
52.0,60.2,68.8,46.8,62.2,53.5,50.9,44.9,73.2,60.4,61.9,
67.8,30.5,52.5,40.4,29.6,58.3,62.6,53.6,64.6,54.4,53.8,49.8,
57.4,63.1,53.4,59.4,48.6,40.7,51.9
)

alpha <- 0.05
variance <- 100
mu0 <- 50
moyenne <- mean(gaz)
quantile <- qnorm(1-alpha)
n <- length(gaz)

# test superiorite: mu > mu0
a <- moyenne - quantile*sqrt(variance)/sqrt(n)
mu0 < a

# Ex 3
avnt<-c(15,18,17,20,21,18,17,15,19,16,19,17,19,15,14,16,21,20,21,18,17,17,
        17,15,17,18,16,10,17,18,14,15,15,17,17,20,17)
aprs<-c(12,16,17,18,17,15,18,14,16,18,20,16,15,17,18,16,15,14,11,13,13,15,
        14,15,19,14,16,14,14,15,19,19,16,19,15,17,16)

length(avnt)
length(aprs)

t.test(avnt,aprs,alternative="g",paired=TRUE)
# significatif


# Ex 4
jus_orange <- c(8.2,9.4,9.6,9.7,10.0,14.5,15.2,16.1,17.6,21.5,14.0,13.8,
             12.8,15.0,9.5,10.9,12.4,14.7,10.7,11.1,13.8,13.1,8.6,13.9,15.2,13.6,13.4,
             12.3,15.2,11.2,19.6,7.8,14.1,12.5,14.1,17.6,13.5,12.4,12.6,14.6,15.5,11.6,
             11.8,12.9,8.1,11.8,18.7,12.6,16.0,15.8,17.2,16.4,11.2,10.2,13.6,13.2,15.9,
             9.8,8.8,12.0)
acide_ascorbique <- c(4.2,5.2,5.8,6.4,7.0,7.3,10.1,11.2,11.3,11.5,7.1,9.8,
                   5.3,4.8,11.9,10.1,12.5,14.6,4.9,9.7,7.0,3.8,5.0,9.3,8.7,8.7,8.7,9.5,2.5,
                   6.6,13.6,6.6,9.4,12.1,13.1,4.1,12.1,8.8,7.0,7.5)

length(jus_orange)
length(acide_ascorbique)

var.test(jus_orange,acide_ascorbique)
# pour voir si les variances sont egales

t.test(jus_orange,acide_ascorbique,alternative="greater",var.equal=FALSE)
# significatif